from langchain.agents import AgentExecutor

from src.agents.retrieval_augmented_generation import rag_chain


def create_task_specific_agent_executor(task_specific_agent):
    executor = AgentExecutor(
        agent=rag_chain(task_specific_agent),
        tools=task_specific_agent.tools,
        verbose=True,
        return_intermediate_steps=True,
        max_iterations=100,
        max_execution_time=60 * 45,  # 45 minutes
        early_stopping_method="generate",
        handle_parsing_errors=True,
    )
    return executor
