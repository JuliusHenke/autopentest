from __future__ import annotations

from typing import Optional, Sequence

from langchain_community.tools import GetElementsTool
from langchain_core.callbacks import (
    AsyncCallbackManagerForToolRun,
    CallbackManagerForToolRun,
)


class CustomGetElementsTool(GetElementsTool):
    """Tool for getting elements in the current web page matching a CSS selector."""

    def _run(
            self,
            selector: str,
            attributes: Sequence[str] = ["innerText"],
            run_manager: Optional[CallbackManagerForToolRun] = None,
    ) -> str:
        try:
            return super()._run(selector=selector, attributes=attributes, run_manager=run_manager)
        except Exception as e:
            return str(e)

    async def _arun(
            self,
            selector: str,
            attributes: Sequence[str] = ["innerText"],
            run_manager: Optional[AsyncCallbackManagerForToolRun] = None,
    ) -> str:
        try:
            return await super()._arun(selector=selector, attributes=attributes, run_manager=run_manager)
        except Exception as e:
            return str(e)
