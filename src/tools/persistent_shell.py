import logging

from langchain_core.pydantic_v1 import Field

from src.tools.base_shell import BaseShell, get_default_bash_process, get_platform
from src.tools.bash_process import BashProcess

logger = logging.getLogger(__name__)


class PersistentShell(BaseShell):
    """Tool to run a persistent shell"""

    process: BashProcess = Field(default_factory=lambda: get_default_bash_process(True))
    """Bash process to run commands."""

    name: str = "persistent_shell"
    """Name of tool."""

    description: str = f"Run bash commands on this {get_platform()} machine in a persistent shell. Use a realistic timeout in seconds to mitigate indefinite blocking."
    """Description of tool."""
